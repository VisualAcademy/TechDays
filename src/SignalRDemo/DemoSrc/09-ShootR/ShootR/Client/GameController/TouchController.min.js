var Movement=function(){function n(n,t,i,r){this._from=n,this._to=t,this.Direction=i,this._originCrossOver=r,this.Active=!1}return n.prototype.ValidMove=function(n){return this._originCrossOver?n>=this._to||n<=this._from&&n>=0:n>=this._from&&n<=this._to},n}(),TouchController=function(){function n(t,i,r,u,f){this._startMovement=t,this._stopMovement=i,this._stopAndStartMovement=r,this._resetMovement=u,this._shipFire=f,this.Forward=new Movement(20,160,"Forward"),this.Backward=new Movement(200,340,"Backward"),this.RotatingLeft=new Movement(125,235,"RotatingLeft"),this.RotatingRight=new Movement(55,305,"RotatingRight",!0),this.Enabled=!0,this._mouseAdapter=new MouseAdapter(this,this.handleStart,this.handleMove,this.handleStop),this._touchAdapter=new TouchAdapter(this,this.handleStart,this.handleMove,this.handleStop),this._ieTouchAdapter=new IETouchAdapter(this,this.handleStart,this.handleMove,this.handleStop),this._canvas=document.getElementById("game"),this._shootPosition=!1,this._shootDrawStart=!1,this._leftJoyStick=new JoyStick(n.LENGTH_OFFSET,[this.Forward,this.Backward],this._startMovement,this._stopMovement,this._stopAndStartMovement,this._resetMovement),this._rightJoyStick=new JoyStick(n.LENGTH_OFFSET,[this.RotatingLeft,this.RotatingRight],this._startMovement,this._stopMovement,this._stopAndStartMovement,this._resetMovement)}return n.LENGTH_OFFSET=22,n.DRAW_SHOTS_FOR=100,n.prototype.handleStart=function(n){this.Enabled&&(n.clientX<=this._middle?this._leftJoyStick.InAction||this._leftJoyStick.TouchStart(n):this._rightJoyStick.InAction||this._rightJoyStick.TouchStart(n))},n.prototype.handleMove=function(n){this.Enabled&&(this._leftJoyStick.TouchMove(n),this._rightJoyStick.TouchMove(n))},n.prototype.handleStop=function(t){this.Enabled&&((this._leftJoyStick.InAction&&this._leftJoyStick.Traveled()<n.LENGTH_OFFSET&&this._leftJoyStick.TimeSinceTouch()<=1e3||this._rightJoyStick.InAction&&this._rightJoyStick.Traveled()<n.LENGTH_OFFSET&&this._rightJoyStick.TimeSinceTouch()<=1e3)&&(this._shootPosition=new Vector2(t.clientX,t.clientY),this._shootDrawStart=(new Date).getTime(),this._shipFire(this._shootDrawStart)),this._leftJoyStick.TouchStop(t),this._rightJoyStick.TouchStop(t))},n.prototype.Reset=function(){this.handleStop({identifier:this._leftJoyStick.TouchID}),this.handleStop({identifier:this._rightJoyStick.TouchID})},n.prototype.Initialize=function(n){var t=this;navigator.msPointerEnabled?($(this._canvas).css("-ms-touch-action","none"),this._canvas.addEventListener("MSPointerDown",function(n){t._ieTouchAdapter.Start(n)},!1),this._canvas.addEventListener("MSPointerMove",function(n){t._ieTouchAdapter.Move(n)},!1),this._canvas.addEventListener("MSPointerUp",function(n){t._ieTouchAdapter.Stop(n)},!1),this._canvas.addEventListener("MSPointerCancel",function(n){n.preventDefault()},!1),this._canvas.addEventListener("MSGestureInit",function(n){n.preventManipulation&&n.preventManipulation()},!1),this._canvas.addEventListener("MSHoldVisual",function(n){n.preventDefault()},!1)):"createTouch"in document?(this._canvas.addEventListener("touchstart",function(n){t._touchAdapter.Start(n)},!1),this._canvas.addEventListener("touchmove",function(n){t._touchAdapter.Move(n)},!1),this._canvas.addEventListener("touchend",function(n){t._touchAdapter.Stop(n)},!1)):(this._canvas.addEventListener("mousedown",function(n){t._mouseAdapter.Start(n)},!1),this._canvas.addEventListener("mousemove",function(n){t._mouseAdapter.Move(n)},!1),this._canvas.addEventListener("mouseup",function(n){t._mouseAdapter.Stop(n)},!1)),this._middle=n.Viewport.Width/2;$(n).on("UpdateScreen",function(){t._middle=n.Viewport.Width/2})},n.prototype.Draw=function(){this._leftJoyStick.Draw(),this._rightJoyStick.Draw(),this._shootDrawStart!==!1&&((new Date).getTime()-this._shootDrawStart>=n.DRAW_SHOTS_FOR?(this._shootDrawStart=!1,this._shootPosition=!1):(CanvasContext.drawCircle(this._shootPosition.X,this._shootPosition.Y,40,6,"#FA6400"),CanvasContext.drawCircle(this._shootPosition.X,this._shootPosition.Y,50,2,"#FA6400")))},n}()