var JoyStick=function(){function n(n,t,i,r,u,f){this._activeJoystickDistance=n,this._movementList=t,this._startMovement=i,this._stopMovement=r,this._stopAndStartMovement=u,this._resetMovement=f,this._controlling=!1,this.TouchID=!1,this.PositionStart=Vector2.Zero(),this.Position=Vector2.Zero(),this.InAction=!1,this.InActionAt=!1}return n.prototype.getAlteredMovements=function(){var r,t,f,e,i,n,u;if(this.Traveled()>this._activeJoystickDistance){for(this._controlling=!0,r=Vector2.SubtractV(this.Position,this.PositionStart),t=Math.atan2(r.Y,r.X)*-180/Math.PI,t<0&&(t+=360),i=!1,n=0;n<this._movementList.length;n++)u=this._movementList[n].ValidMove(t),!u&&this._movementList[n].Active?(i=!0,f=this._movementList[n]):u&&!this._movementList[n].Active&&(i=!0,e=this._movementList[n]);return{changed:i,toStart:e,toStop:f}}return!1},n.prototype.moveShip=function(n,t){(n||t)&&(n&&t?(n.Active=!1,t.Active=!0,this._stopAndStartMovement(n.Direction,t.Direction)):n?(n.Active=!1,this._stopMovement(n.Direction)):t&&(t.Active=!0,this._startMovement(t.Direction)))},n.prototype.performReset=function(){var t,n;if(this._controlling){for(this._controlling=!1,t=[],n=0;n<this._movementList.length;n++)this._movementList[n].Active=!1,t.push(this._movementList[n].Direction);this._resetMovement(t)}},n.prototype.TimeSinceTouch=function(){return this.InActionAt?(new Date).getTime()-this.InActionAt:!1},n.prototype.Traveled=function(){return CalculateLength(this.Position,this.PositionStart)},n.prototype.TouchStart=function(n){this.TouchID===!1&&(this.InActionAt=(new Date).getTime(),this.InAction=!0,this.PositionStart.X=n.clientX,this.PositionStart.Y=n.clientY,this.TouchID=n.identifier,this.Position=this.PositionStart.Clone())},n.prototype.TouchMove=function(n){if(this.TouchID===n.identifier){this.Position.X=n.clientX,this.Position.Y=n.clientY;var t=this.getAlteredMovements();return t?t.changed&&this.moveShip(t.toStop,t.toStart):this.performReset(),!0}return!1},n.prototype.TouchStop=function(n){return this.TouchID===n.identifier?(this.InAction=!1,this.TouchID=!1,this.InActionAt=!1,this.performReset(),!0):!1},n.prototype.Draw=function(){this.InAction&&(this.TimeSinceTouch()>1e3||this.Traveled()>=this._activeJoystickDistance)&&(CanvasContext.drawCircle(this.PositionStart.X,this.PositionStart.Y,40,5,"#1BFF27"),CanvasContext.drawCircle(this.PositionStart.X,this.PositionStart.Y,60,2,"#1BFF27"),CanvasContext.drawCircle(this.Position.X,this.Position.Y,40,2,"#2EBD15"),CanvasContext.drawLine(this.PositionStart.X,this.PositionStart.Y,this.Position.X,this.Position.Y,2,"#4A993C"))},n}()